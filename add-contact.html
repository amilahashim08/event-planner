<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>sa.bbi - Event Management Dashboard</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="./assets/style.css">
    <style>
        body {
            background: #F1EDE1;
            font-family: 'Segoe UI', Arial, sans-serif;
        }

        .sidebar {
            background: #F1EDE1;
            min-height: 100vh;
            width: 250px;
            position: fixed;
            left: 0;
            top: 0;
            z-index: 100;
            transition: width 0.3s;
        }

        .sidebar.collapsed {
            width: 80px;
        }

        .sidebar .logo {
            padding: 24px 16px 12px 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .sidebar .logo img {
            height: 40px;
        }

        .sidebar .toggle-btn {
            background: none;
            border: none;
            font-size: 20px;
            color: #9B4431;
            cursor: pointer;
        }

        .sidebar .nav {
            flex-direction: column;
            gap: 8px;
            margin-top: 24px;
        }

        .sidebar .nav-link {
            color: #3B3F53;
            font-weight: 500;
            padding: 12px 24px;
            border-radius: 8px;
            margin: 4px;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 16px;
            transition: background 0.2s;
        }

        .sidebar .nav-link.active,
        .sidebar .nav-link:hover {
            background: #9B4431;
            color: #fff;
            font-weight: 600;
        }

        .sidebar.collapsed .nav-link span {
            display: none;
        }

        .sidebar.collapsed .nav-link {
            justify-content: center;
            padding: 12px 0;
        }

        .main-content {
            margin-left: 250px;
            transition: margin-left 0.3s;
        }

        .sidebar.collapsed~.main-content {
            margin-left: 80px;
        }

        @media (max-width: 900px) {
            .sidebar {
                position: absolute;
                left: -250px;
                width: 250px;
            }

            .sidebar.show {
                left: 0;
            }

            .main-content {
                margin-left: 0;
            }
        }

        .header {
            background: #F1EDE1;
            /* padding: 44px 32px 8px 32px; */
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .header .module-name {
            font-size: 22px;
            font-weight: 600;
            color: #9B4431;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 24px;
        }


        .nav-tabs .nav-item.show .nav-link,
        .nav-tabs .nav-link.active {
            color: var(--bs-nav-tabs-link-active-color);
            background-color: transparent !important;
            border-color: var(--bs-nav-tabs-link-active-border-color);
        }

        .nav-item {
            margin: 10px -12px;
        }
         .logout-btn {
            background: none;
            border: none;
            color: #9B4431;
            font-size: 18px;
            cursor: pointer;
        }
    </style>
</head>

<body>
    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="logo">
            <img src="./assets/images/sa.bbi (2).svg" alt="Logo">
            <button class="toggle-btn" onclick="toggleSidebar()">
                <i class="fa-solid fa-angles-left"></i>
            </button>
        </div>
        <nav class="nav">
            <a href="index.html" class="nav-link"><i class="fas fa-tachometer-alt"></i> <span>Dashboard</span></a>
            <a href="event.html" class="nav-link "><i class="fas fa-calendar-alt"></i> <span>Events</span></a>
            <a href="contact.html" class="nav-link active"><i class="fas fa-users"></i> <span>Contacts</span></a>
            <a href="template.html" class="nav-link "><i class="fas fa-file-alt"></i> <span>Templates</span></a>
            <a href="setting.html" class="nav-link "><i class="fas fa-cog"></i> <span>Settings</span></a>
        </nav>
    </div>


    <!-- Main Content -->
    <div class="main-content" id="mainContent">
        <!-- Header -->
       <div class="header">
            <h6 class="">Contact</h6>
            <div class="header-right">
                <div class="language-selector">
                    <i class="fas fa-globe"></i>
                    <span>English</span>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="profile-image">
                    <img src="assets/images/image-4 (7).png" alt="User">
                </div>
             <button class="logout-btn" title="Logout" onclick="window.location.href = 'signin.html'"><i
                        class="fas fa-sign-out-alt"></i></button>  </div>
        </div>


        <!-- Content Area -->
        <div class="content-area">
            <h5 class="mb-1"> <i class="fas fa-arrow-left me-3 cursor-pointer"
                    onclick="window.location.href = 'contact.html'"></i> Add New Contact</h5>

            <div class="card p-4">
                <form id="addContactForm">
                    <div class="row">
                        <!-- Left Column -->
                        <div class="col-md-8">
                            <div class="contact-details-section">
                                <h6 class="section-subtitle mb-3">Contact Details</h6>

                                <div class="row mb-3">
                                    <div class="col-md-4">
                                        <label for="contactCategory" class="form-label">Category</label>
                                        <select class="form-select custom-select" id="contactCategory" required>
                                            <option value="">Category</option>
                                            <option value="Florist">Florist</option>
                                            <option value="Photographer">Photographer</option>
                                            <option value="Videographer">Videographer</option>
                                            <option value="DJ / Musician">DJ / Musician</option>
                                            <option value="Venue">Venue</option>
                                            <option value="Makeup Artist">Makeup Artist</option>
                                            <option value="Cake Baker">Cake Baker</option>
                                            <option value="Planner Assistant">Planner Assistant</option>
                                            <option value="Security">Security</option>
                                            <option value="Lighting">Lighting</option>
                                            <option value="Transportation">Transportation</option>
                                            <option value="Custom Vendor">Custom Vendor</option>
                                        </select>
                                    </div>
                                    <div class="col-md-4">
                                        <label for="firstName" class="form-label">First Name</label>
                                        <input type="text" class="form-control" id="firstName" placeholder="First Name"
                                            required>
                                    </div>
                                    <div class="col-md-4">
                                        <label for="lastName" class="form-label">Last Name</label>
                                        <input type="text" class="form-control" id="lastName" placeholder="Last Name"
                                            required>
                                    </div>
                                </div>

                                <div class="row mb-3">
                                    <div class="col-md-4">
                                        <label for="emailAddress" class="form-label">Email</label>
                                        <input type="email" class="form-control" id="emailAddress" placeholder="Email"
                                            required>
                                    </div>
                                    <div class="col-md-4">
                                        <label for="whatsapp" class="form-label">Whatsapp</label>
                                        <input type="tel" class="form-control" id="whatsapp" placeholder="Whatsapp">
                                    </div>
                                    <div class="col-md-4">
                                        <label for="address" class="form-label">Address</label>
                                        <input type="text" class="form-control" id="address" placeholder="Address">
                                    </div>
                                </div>

                                <div class="row mb-4">
                                    <div class="col-md-4">
                                        <label for="paymentMethod" class="form-label">Payment Method</label>
                                        <select class="form-select custom-select" id="paymentMethod">
                                            <option value="">Payment Method</option>
                                            <option value="Cash">Cash</option>
                                            <option value="Bank Transfer">Bank Transfer</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="notes-section mb-4">
                                    <div class="d-flex justify-content-between align-items-center mb-3">
                                        <h6 class="section-subtitle mb-0">Notes</h6>
                                        <button type="button" class="btn btn-link btn-sm text-primary p-0">Add
                                            More</button>
                                    </div>
                                    <textarea class="form-control" id="notes" rows="3"
                                        placeholder="Enter Text"></textarea>
                                </div>

                               
                            </div>
                        </div>

                        <!-- Right Column - Photo Upload -->
                        <div class="col-md-4">
                            <div class="photo-upload-section">
                                <div class="photo-upload-area">
                                    <div class="photo-placeholder">
                                        <i class="fas fa-camera"></i>
                                        <div class="upload-text">Add Photo</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                         <div class=" border-top-0 d-flex justify-content-end">
                                    <button type="button" class="btn btn-primary-custom px-4">Add</button>
                                </div>
                    </div>
                </form>
            </div>

        </div>

    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- jQuery (required for DataTables) -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <!-- DataTables JS -->


    <script>
        class ContactsManagerDT {
            constructor() {
                this.contacts = [
                    {
                        id: 1234,
                        category: "Photographer",
                        company: "Frame Perfect",
                        name: "Nicolas Palmer",
                        firstName: "Nicolas",
                        lastName: "Palmer",
                        phone: "1234567890",
                        email: "nicolas@gmail.com",
                        website: "frame.perfect.com",
                        location: "Massa Cabrería, Spain Catalonia",
                        avatar: { bg: "#EF4444", initial: "NP", color: "red" }
                    },
                    {
                        id: 1235,
                        category: "Photographer",
                        company: "Rose Blooms Co.",
                        name: "Jonathan Jones",
                        firstName: "Jonathan",
                        lastName: "Jones",
                        phone: "1234567891",
                        email: "jonathan@gmail.com",
                        website: "rose.blooms.co.com",
                        location: "Massa Cabrería, Spain Catalonia",
                        avatar: { bg: "#F59E0B", initial: "JJ", color: "yellow" }
                    },
                    {
                        id: 1236,
                        category: "Florist",
                        company: "Frame Perfect",
                        name: "Joe Meyer",
                        firstName: "Joe",
                        lastName: "Meyer",
                        phone: "1234567892",
                        email: "joe@gmail.com",
                        website: "frame.perfect.com",
                        location: "Massa Cabrería, Spain Catalonia",
                        avatar: { bg: "#EC4899", initial: "JM", color: "pink" }
                    },
                    {
                        id: 1237,
                        category: "Videographer",
                        company: "Rose Blooms Co.",
                        name: "Justin Wood",
                        firstName: "Justin",
                        lastName: "Wood",
                        phone: "1234567893",
                        email: "justin@gmail.com",
                        website: "rose.blooms.co.com",
                        location: "Massa Cabrería, Spain Catalonia",
                        avatar: { bg: "#06B6D4", initial: "JW", color: "blue" }
                    },
                    {
                        id: 1238,
                        category: "Florist",
                        company: "Frame Perfect",
                        name: "Jacob Evans",
                        firstName: "Jacob",
                        lastName: "Evans",
                        phone: "1234567894",
                        email: "jacob@gmail.com",
                        website: "frame.perfect.com",
                        location: "Massa Cabrería, Spain Catalonia",
                        avatar: { bg: "#EC4899", initial: "JE", color: "pink" }
                    },
                    {
                        id: 1239,
                        category: "Caterer",
                        company: "Delicious Delights",
                        name: "Sarah Williams",
                        firstName: "Sarah",
                        lastName: "Williams",
                        phone: "1234567895",
                        email: "sarah@delicious.com",
                        website: "delicious-delights.com",
                        location: "Barcelona, Spain Catalonia",
                        avatar: { bg: "#10B981", initial: "SW", color: "green" }
                    },
                    {
                        id: 1240,
                        category: "DJ",
                        company: "Sound Waves",
                        name: "Mike Johnson",
                        firstName: "Mike",
                        lastName: "Johnson",
                        phone: "1234567896",
                        email: "mike@soundwaves.com",
                        website: "sound-waves.com",
                        location: "Madrid, Spain",
                        avatar: { bg: "#8B5CF6", initial: "MJ", color: "purple" }
                    }
                ];

                this.dataTable = null;
                this.init();
            }

            init() {
                // Wait for DOM and jQuery to be ready
                $(document).ready(() => {
                    this.setupSidebarToggle();
                    this.setupEventListeners();
                    this.initializeDataTable();
                });
            }

            initializeDataTable() {
                // Prepare data for DataTables
                const tableData = this.contacts.map((contact, index) => [
                    contact.id,
                    contact.category,
                    contact.company,
                    this.formatContactName(contact),
                    contact.phone,
                    contact.email,
                    contact.website,
                    this.formatActionButtons(index)
                ]);

                // Initialize DataTable with responsive features
                this.dataTable = $('#contactsTable').DataTable({
                    data: tableData,
                    responsive: {
                        details: {
                            type: 'column',
                            target: 'tr'
                        }
                    },
                    columnDefs: [
                        {
                            targets: 0,
                            className: 'dt-control',
                            orderable: false,
                            searchable: false
                        },
                        {
                            targets: -1,
                            orderable: false,
                            searchable: false
                        }
                    ],
                    pageLength: 10,
                    lengthMenu: [[5, 10, 25, 50], [5, 10, 25, 50]],
                    language: {
                        search: "",
                        searchPlaceholder: "Search contacts...",
                        lengthMenu: "Show _MENU_ entries",
                        info: "Showing _START_ to _END_ of _TOTAL_ contacts",
                        paginate: {
                            first: "First",
                            last: "Last",
                            next: '<i class="fas fa-chevron-right"></i>',
                            previous: '<i class="fas fa-chevron-left"></i>'
                        }
                    },
                    dom: '<"row"<"col-sm-12 col-md-6"l><"col-sm-12 col-md-6"f>>' +
                        '<"row"<"col-sm-12"tr>>' +
                        '<"row"<"col-sm-12 col-md-5"i><"col-sm-12 col-md-7"p>>',
                    drawCallback: () => {
                        this.initializeTooltips();
                    }
                });

                // Custom search integration
                this.setupCustomSearch();

                // Hide default search and pagination since we have custom ones
                this.customizeDataTableElements();
            }

            formatContactName(contact) {
                return `
            <div class="d-flex align-items-center">
                <div class="contact-avatar ${contact.avatar.color}">
                    ${contact.avatar.initial}
                </div>
                <span class="contact-name-cell">
                    ${contact.name}
                </span>
            </div>
        `;
            }

            formatActionButtons(index) {
                return `
            <div class="action-buttons">
                <button class="action-btn view" data-bs-toggle="tooltip" title="View" onclick="contactsManagerDT.viewContact(${index})">
                    <i class="fas fa-eye"></i>
                </button>
                <button class="action-btn delete" data-bs-toggle="tooltip" title="Delete" onclick="contactsManagerDT.deleteContact(${index})">
                    <i class="fas fa-trash"></i>
                </button>
                <button class="action-btn edit" data-bs-toggle="tooltip" title="Edit" onclick="contactsManagerDT.editContact(${index})">
                    <i class="fas fa-edit"></i>
                </button>
            </div>
        `;
            }

            setupCustomSearch() {
                // Integrate custom search with DataTables
                $('#searchInput').on('keyup', (e) => {
                    this.dataTable.search(e.target.value).draw();
                });

                // Integrate category filter
                $('#categoryFilter').on('change', (e) => {
                    const category = e.target.value;
                    if (category) {
                        this.dataTable.column(1).search(category).draw();
                    } else {
                        this.dataTable.column(1).search('').draw();
                    }
                });
            }

            customizeDataTableElements() {
                // Hide DataTables default search and info
                $('.dataTables_filter').hide();
                $('.dataTables_length').hide();
                $('.dataTables_info').hide();
                $('.dataTables_paginate').hide();

                // Style DataTables elements
                $('.dataTables_wrapper').addClass('responsive-wrapper');
            }

            setupEventListeners() {

                $('#prevPage').on('click', () => {
                    this.dataTable.page('previous').draw('page');
                });

                $('#nextPage').on('click', () => {
                    this.dataTable.page('next').draw('page');
                });
            }

            setupSidebarToggle() {
                const sidebar = $('#sidebar');
                const toggle = $('#sidebarToggle');

                if (toggle.length && sidebar.length) {
                    toggle.on('click', () => {
                        if ($(window).width() <= 768) {
                            sidebar.toggleClass('open');
                        } else {
                            sidebar.toggleClass('collapsed');
                        }
                    });
                }

                // Close sidebar when clicking outside on mobile
                $(document).on('click', (e) => {
                    if ($(window).width() <= 768 &&
                        sidebar.hasClass('open') &&
                        !sidebar.is(e.target) &&
                        sidebar.has(e.target).length === 0 &&
                        !toggle.is(e.target) &&
                        toggle.has(e.target).length === 0) {
                        sidebar.removeClass('open');
                    }
                });
            }

            initializeTooltips() {
                // Initialize Bootstrap tooltips
                $('[data-bs-toggle="tooltip"]').tooltip();
            }

            viewContact(index) {
                const contact = this.contacts[index];
                if (contact) {
                    window.location.href = `contact-detail.html?id=${index}`;
                }
            }

            deleteContact(index) {
                const contact = this.contacts[index];
                if (contact && confirm(`Are you sure you want to delete ${contact.name}?`)) {
                    // Remove from data array
                    this.contacts.splice(index, 1);

                    // Update DataTable
                    this.dataTable.clear();
                    const newData = this.contacts.map((contact, newIndex) => [
                        contact.id,
                        contact.category,
                        contact.company,
                        this.formatContactName(contact),
                        contact.phone,
                        contact.email,
                        contact.website,
                        this.formatActionButtons(newIndex)
                    ]);
                    this.dataTable.rows.add(newData).draw();

                    this.showMessage('Contact deleted successfully', 'success');
                }
            }

            editContact(index) {
                const contact = this.contacts[index];
                if (contact) {
                    this.showMessage('Edit functionality would open edit form', 'info');
                }
            }

            showMessage(message, type = 'info') {
                // Create message element using jQuery
                const alertClass = type === 'error' ? 'danger' : type === 'success' ? 'success' : 'info';
                const messageEl = $(`
            <div class="alert alert-${alertClass} alert-dismissible fade show" style="position: fixed; top: 20px; right: 20px; z-index: 9999; min-width: 300px;">
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>
        `);

                $('body').append(messageEl);

                // Auto remove after 5 seconds
                setTimeout(() => {
                    messageEl.remove();
                }, 5000);
            }

            setActiveNavItem(item) {
                // Remove active class from all nav items
                $('.nav-item').removeClass('active');

                // Add active class to clicked item
                if (item) {
                    $(item).addClass('active');
                }
            }
        }

        // Initialize the contacts manager with DataTables
        let contactsManagerDT;
        $(document).ready(() => {
            contactsManagerDT = new ContactsManagerDT();
        });
        // Sidebar toggle functionality
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.getElementById('mainContent');

            sidebar.classList.toggle('collapsed');
            mainContent.classList.toggle('sidebar-collapsed');
        }

        // Navigation functionality
        function navigateTo(module) {
            // Remove active class from all nav links
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });

            // Add active class to clicked nav link
            event.target.closest('.nav-link').classList.add('active');

            // Update header title
            const headerTitle = document.querySelector('.header-left h4');
            headerTitle.textContent = module.charAt(0).toUpperCase() + module.slice(1);

            // Here you would typically load different content based on the module
            console.log(`Navigating to ${module}`);
        }

        // Search functionality
        function searchEvents() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const eventCards = document.querySelectorAll('.event-card');

            eventCards.forEach(card => {
                const title = card.querySelector('.event-title').textContent.toLowerCase();
                const type = card.querySelector('.event-type span').textContent.toLowerCase();

                if (title.includes(searchTerm) || type.includes(searchTerm)) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        // Event card selection
        function selectEvent(eventId) {
            console.log(`Selected event: ${eventId}`);
            // Here you would typically show event details or navigate to event page
        }

        // Edit event functionality
        function editEvent(eventId, event) {
            event.stopPropagation(); // Prevent card selection
            console.log(`Editing event: ${eventId}`);
            alert(`Edit event ${eventId} - This would open an edit modal`);
        }

        // Delete event functionality
        function deleteEvent(eventId, event) {
            event.stopPropagation(); // Prevent card selection
            console.log(`Deleting event: ${eventId}`);

            if (confirm(`Are you sure you want to delete this event?`)) {
                // Here you would typically make an API call to delete the event
                const eventCard = event.target.closest('.event-card');
                eventCard.style.animation = 'fadeOut 0.3s ease';
                setTimeout(() => {
                    eventCard.remove();
                }, 300);
            }
        }

        // Modal functionality
        function showModal(modalId) {
            document.getElementById(modalId).classList.add('show');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('show');

            // Close calendar if open
            if (modalId === 'eventFormModal') {
                document.getElementById('customCalendar').classList.remove('show');
            }
        }

        // Event functionality
        function selectEvent(eventId) {
            console.log('Selected event:', eventId);
            // Add your event selection logic here
        }

        function editEvent(eventId, event) {
            event.stopPropagation(); // Prevent card click
            console.log('Editing event:', eventId);

            // Show success modal for update
            document.getElementById('successMessage').textContent = 'Event details has been updated Successfully !';
            showModal('successModal');
        }

        function deleteEvent(eventId, event) {
            event.stopPropagation(); // Prevent card click
            console.log('Deleting event:', eventId);

            // Get event name from card
            const eventCard = event.target.closest('.event-card');
            const eventTitle = eventCard.querySelector('.event-title').textContent;

            // Set delete modal content
            currentDeleteEventId = eventId;
            currentDeleteEventName = eventTitle;
            document.getElementById('deleteMessage').textContent = `the project "${eventTitle}" ?`;

            showModal('deleteModal');
        }

        function confirmDelete() {
            closeModal('deleteModal');

            // Remove the event card from DOM
            const eventCards = document.querySelectorAll('.event-card');
            eventCards.forEach(card => {
                const title = card.querySelector('.event-title').textContent;
                if (title === currentDeleteEventName) {
                    card.remove();
                }
            });

            // Show success modal
            document.getElementById('successMessage').textContent = `${currentDeleteEventName} has been deleted Successfully !`;
            showModal('successModal');
        }

        function addEvent() {
            console.log('Adding new event');

            // Random chance to show event limit modal (simulate limit reached)
            if (Math.random() < 0.3) {
                showModal('eventLimitModal');
            } else {
                showModal('eventTypeModal');
            }
        }

        function changePlan() {
            closeModal('eventLimitModal');
            console.log('Redirecting to change plan...');
        }


        // Date filter functionality
        document.getElementById('dateFilter').addEventListener('change', function () {
            const selectedDate = this.value;
            console.log(`Filtering by date: ${selectedDate}`);
            // Here you would typically filter events by the selected date
        });

        // Auto-collapse sidebar on small screens
        function handleResize() {
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.getElementById('mainContent');

            if (window.innerWidth <= 768) {
                sidebar.classList.add('collapsed');
                mainContent.classList.add('sidebar-collapsed');
            } else {
                sidebar.classList.remove('collapsed');
                mainContent.classList.remove('sidebar-collapsed');
            }
        }

        // Initialize responsive behavior
        window.addEventListener('resize', handleResize);
        handleResize(); // Call on page load

        // Add fade out animation for delete
        const style = document.createElement('style');
        style.textContent = `
            @keyframes fadeOut {
                0% { opacity: 1; transform: scale(1); }
                100% { opacity: 0; transform: scale(0.8); }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>

</html>